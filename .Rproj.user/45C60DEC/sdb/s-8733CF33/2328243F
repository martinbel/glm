{
    "contents" : "# Chapter 4 Lab: Logistic Regression, LDA, QDA, and KNN\n\n# The Stock Market Data\n\nlibrary(ISLR)\nnames(Smarket)\ndim(Smarket)\nsummary(Smarket)\npairs(Smarket)\ncor(Smarket)\ncor(Smarket[,-9])\nattach(Smarket)\nplot(Volume)\n\n# Logistic Regression\n\nglm.fit=glm(Direction~Lag1+Lag2+Lag3+Lag4+Lag5+Volume,data=Smarket,family=binomial)\nsummary(glm.fit)\ncoef(glm.fit)\nsummary(glm.fit)$coef\nsummary(glm.fit)$coef[,4]\nglm.probs=predict(glm.fit,type=\"response\")\nglm.probs[1:10]\n\ncontrasts(Direction)\n\nglm.pred <- ifelse(glm.probs > 0.5, 'Up', 'Down')\n\nglm.pred=rep(\"Down\",1250)\nglm.pred[glm.probs>.5]=\"Up\"\n\ntable(glm.pred,Direction)\n(507+145)/1250\nmean(glm.pred==Direction)\ntrain=(Year<2005)\nSmarket.2005=Smarket[!train,]\ndim(Smarket.2005)\n\nDirection.2005=Direction[!train]\nglm.fit=glm(Direction~Lag1+Lag2+Lag3+Lag4+Lag5+Volume,data=Smarket,family=binomial,subset=train)\nglm.probs=predict(glm.fit,Smarket.2005,type=\"response\")\nglm.pred=rep(\"Down\",252)\nglm.pred[glm.probs>.5]=\"Up\"\ntable(glm.pred,Direction.2005)\nmean(glm.pred==Direction.2005)\nmean(glm.pred!=Direction.2005)\nglm.fit=glm(Direction~Lag1+Lag2,data=Smarket,family=binomial,subset=train)\nglm.probs=predict(glm.fit,Smarket.2005,type=\"response\")\nglm.pred=rep(\"Down\",252)\nglm.pred[glm.probs>.5]=\"Up\"\ntable(glm.pred,Direction.2005)\nmean(glm.pred==Direction.2005)\n106/(106+76)\npredict(glm.fit,newdata=data.frame(Lag1=c(1.2,1.5),Lag2=c(1.1,-0.8)),type=\"response\")\n\n# Linear Discriminant Analysis\n\nlibrary(MASS)\nlda.fit=lda(Direction~Lag1+Lag2,data=Smarket,subset=train)\nlda.fit\nplot(lda.fit)\nlda.pred=predict(lda.fit, Smarket.2005)\nnames(lda.pred)\nlda.class=lda.pred$class\ntable(lda.class,Direction.2005)\nmean(lda.class==Direction.2005)\nsum(lda.pred$posterior[,1]>=.5)\nsum(lda.pred$posterior[,1]<.5)\nlda.pred$posterior[1:20,1]\nlda.class[1:20]\nsum(lda.pred$posterior[,1]>.9)\n\n# Quadratic Discriminant Analysis\n\nqda.fit=qda(Direction~Lag1+Lag2,data=Smarket,subset=train)\nqda.fit\nqda.class=predict(qda.fit,Smarket.2005)$class\ntable(qda.class,Direction.2005)\nmean(qda.class==Direction.2005)\n\n# K-Nearest Neighbors\n\nlibrary(class)\ntrain.X=cbind(Lag1,Lag2)[train,]\ntest.X=cbind(Lag1,Lag2)[!train,]\ntrain.Direction=Direction[train]\nset.seed(1)\nknn.pred=knn(train.X,test.X,train.Direction,k=1)\ntable(knn.pred,Direction.2005)\n(83+43)/252\nknn.pred=knn(train.X,test.X,train.Direction,k=3)\ntable(knn.pred,Direction.2005)\nmean(knn.pred==Direction.2005)\n\n# An Application to Caravan Insurance Data\n\ndim(Caravan)\nattach(Caravan)\nsummary(Purchase)\n348/5822\nstandardized.X=scale(Caravan[,-86])\nvar(Caravan[,1])\nvar(Caravan[,2])\nvar(standardized.X[,1])\nvar(standardized.X[,2])\ntest=1:1000\ntrain.X=standardized.X[-test,]\ntest.X=standardized.X[test,]\ntrain.Y=Purchase[-test]\ntest.Y=Purchase[test]\nset.seed(1)\nknn.pred=knn(train.X,test.X,train.Y,k=1)\nmean(test.Y!=knn.pred)\nmean(test.Y!=\"No\")\ntable(knn.pred,test.Y)\n9/(68+9)\nknn.pred=knn(train.X,test.X,train.Y,k=3)\ntable(knn.pred,test.Y)\n5/26\nknn.pred=knn(train.X,test.X,train.Y,k=5)\ntable(knn.pred,test.Y)\n4/15\nglm.fit=glm(Purchase~.,data=Caravan,family=binomial,subset=-test)\nglm.probs=predict(glm.fit,Caravan[test,],type=\"response\")\nglm.pred=rep(\"No\",1000)\nglm.pred[glm.probs>.5]=\"Yes\"\ntable(glm.pred,test.Y)\nglm.pred=rep(\"No\",1000)\nglm.pred[glm.probs>.25]=\"Yes\"\ntable(glm.pred,test.Y)\n11/(22+11)",
    "created" : 1417314490673.000,
    "dirty" : false,
    "encoding" : "LATIN1",
    "folds" : "",
    "hash" : "616718968",
    "id" : "2328243F",
    "lastKnownWriteTime" : 1417322130,
    "path" : "~/Desktop/dm/glm/4_lab.R",
    "project_path" : "4_lab.R",
    "properties" : {
        "tempName" : "Untitled4"
    },
    "source_on_save" : false,
    "type" : "r_source"
}